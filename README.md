# Sumo Wrestling Machine Learning Project


## Intro
The goal of this project was to use machine learning to **predict the outcomes of sumo wrestling bouts** in Japan Sumo Grand Tournaments. There are few Western attempts at using sports analytics on Eastern sports, and this is an attempt at filling that gap.


## Process
First, I **built a database by scraping and parsing data** from publicly available information at [Sumo Reference] using [Beautiful Soup]. This website contains data on sumo wrestlers, tournament outcomes, etc. dating back to as early as 1600. I scrape basic profile info (e.g. height, weight, rank) as well as head-to-head matches (outcomes of matches between two sumo wrestlers). The resulting database contains **12,374 unique sumo wrestler profiles** and the outcomes of almost **200,000 head-to-head matches** dating back to the early 2000's.

Next, I **visualized the data to observe interesting trends, clean data, and look for features** to include for the machine learning model. Plots were generated using [Seaborn] and saved as PNG's.

Finally, I **trained a logistic regression model on this data** to predict the outcomes of new matches during the 2017 March Grand Tournament (Haru Basho). Current features used are **differences** in the following values between two sumo wrestlers:

   - Height
   - Weight
   - Age
   - Active Number of Years
   - Rank
   - Head-to-Head Win Percentage (of previous matches between two sumos, what percentage of them did one sumo win against the other?)

## Plots

Below are a couple interesting plots I generated. Makuuchi refers to the top division of sumo wrestlers (sumos good enough to compete in the Grand Tournaments).

![wp_distribution](plots/makuuchi_wp_distrib.png){:height="50%" width="50%"}

![wp_vs_weight](plots/makuuchi_wp_vs_weight.png)


## Results

Cross-Validation F1 Score (a measure of accuracy in predicting wins): 57.1%

F1 Score for ~300 unseen matches in 2017 March Grand Tourney: 60.8%


## Future Work

   - Gather more interesting features (e.g. scrape professional sumo's Twitter profiles?)
   - Perform more work with feature selection
   - Try different classifier algorithms


## Folders

data/  : contains data collected from online, public database using Beautiful Soup Library. Stored as pickle files from pandas dataframes.

plots/ : contains visualizations of data in Seaborn plots saved as png's.

tourneys/ : contains daily tourney head-to-head lineups for March (Haru) Basho 2017.


## Python Scripts and Modules

**data_extraction.py** : Module with helper functions for processing information extracted from html tags using scraping libraries (e.g. Beautiful Soup). 

**database_ops.py** : Module with helper functions to perform various operations with DataFrames.

**feature_generation.py** : Script to generate DataFrame containing feature data and labels.

**filter_duplicates.py** : Script to filter out the duplicate rows in raw head-to-head DataFrame generated by feature generation script.

**machine_learning.py** : Script for doing various machine learning tasks, including model evaluation & predicting outcomes of new bouts.

**ml_fxns.py** : Module with helper functions for various machine learning tasks. Could include data pre-processing tasks, prediction tasks, etc.

**rikishi_scrape.py** : Module with functions used for scraping data with Beautiful Soup. Functions are used when scraping data from multiple html pages/sumo wrestlers.

**scrape_multiple_h2h.py** : Script to scrape head-to-head data for multiple sumo wrestlers.

**scrape_multiple_rikishi.py** : Script to scrape basic profile data for multiple sumo wrestlers.


## Jupyter Notebooks

**ml_playground.ipynb** : notebook for playing around with various machine learning tasks.

**testing_playground.ipynb** : notebook for testing miscellaneous pieces of code.

**visualizations.ipynb** : notebook for generating Seaborn visualizations of scraped data.



[Seaborn]: <https://seaborn.pydata.org/>
[Sumo Reference]: <http://sumodb.sumogames.de/>
[Beautiful Soup]: <https://www.crummy.com/software/BeautifulSoup/bs4/doc/>